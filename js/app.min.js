(function(){"use strict";var data=localStorage.getItem("data");var form=document.querySelector("form");function populateForm(data){if(!data)return;data=JSON.parse(data);for(var field in data){switch(field){case"superheroes":data[field].forEach((function(superhero){document.querySelector("[name='"+superhero+"']").checked=true}));break;case"tos":var savedValue=data[field];var field=Array.prototype.slice.call(document.querySelectorAll("[name='"+field+"']")).filter((function(field){return field.value===savedValue}))[0];field.checked=true;break;default:document.querySelector("[name='"+field+"']").value=data[field]}}}function addToLocalStorageObject(name,key,value){var existing=localStorage.getItem(name);existing=existing?JSON.parse(existing):{};existing[key]=value;localStorage.setItem(name,JSON.stringify(existing))}function saveData(event){var fieldName=event.target.getAttribute("name");var value=event.target.type==="checkbox"?[]:"";if(!fieldName)return;switch(event.target.type){case"radio":value+=document.querySelector("[name='"+fieldName+"']:checked").value;break;case"checkbox":var checked=Array.prototype.slice.call(event.target.closest("div").querySelectorAll(":checked"));checked.forEach((function(checkbox){value.push(checkbox.getAttribute("name"))}));break;default:value=event.target.value}fieldName=Array.isArray(value)?"superheroes":fieldName;addToLocalStorageObject("data",fieldName,value)}function clearData(event){localStorage.removeItem("data")}populateForm(data);form.addEventListener("input",saveData,false);form.addEventListener("submit",clearData,false)})();